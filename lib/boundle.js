var e,t;function r(){}function n(){n.init.call(this)}function i(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function s(e,t,r){if(t)e.call(r);else for(var n=e.length,i=p(e,n),s=0;s<n;++s)i[s].call(r)}function o(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,s=p(e,i),o=0;o<i;++o)s[o].call(r,n)}function l(e,t,r,n,i){if(t)e.call(r,n,i);else for(var s=e.length,o=p(e,s),l=0;l<s;++l)o[l].call(r,n,i)}function a(e,t,r,n,i,s){if(t)e.call(r,n,i,s);else for(var o=e.length,l=p(e,o),a=0;a<o;++a)l[a].call(r,n,i,s)}function h(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,s=p(e,i),o=0;o<i;++o)s[o].apply(r,n)}function u(e,t,n,s){var o,l,a,h;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((l=e._events)?(l.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),l=e._events),a=l[t]):(l=e._events=new r,e._eventsCount=0),a){if("function"==typeof a?a=l[t]=s?[n,a]:[a,n]:s?a.unshift(n):a.push(n),!a.warned&&(o=i(e))&&o>0&&a.length>o){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,h=u,"function"==typeof console.warn?console.warn(h):console.log(h)}}else a=l[t]=n,++e._eventsCount;return e}function f(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function c(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function p(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}(e=self.document)&&!e.getElementById("livereloadscript")&&((t=e.createElement("script")).async=1,t.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",t.id="livereloadscript",e.getElementsByTagName("head")[0].appendChild(t)),Object.defineProperty(exports,"__esModule",{value:!0}),r.prototype=Object.create(null),n.EventEmitter=n,n.usingDomains=!1,n.prototype.domain=void 0,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.init=function(){this.domain=null,n.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new r,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return i(this)},n.prototype.emit=function(e){var t,r,n,i,u,f,c,p="error"===e;if(f=this._events)p=p&&null==f.error;else if(!p)return!1;if(c=this.domain,p){if(t=arguments[1],!c){if(t instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=c,t.domainThrown=!1,c.emit("error",t),!1}if(!(r=f[e]))return!1;var y="function"==typeof r;switch(n=arguments.length){case 1:s(r,y,this);break;case 2:o(r,y,this,arguments[1]);break;case 3:l(r,y,this,arguments[1],arguments[2]);break;case 4:a(r,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),u=1;u<n;u++)i[u-1]=arguments[u];h(r,y,this,i)}return!0},n.prototype.addListener=function(e,t){return u(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return u(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,f(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,f(this,e,t)),this},n.prototype.removeListener=function(e,t){var n,i,s,o,l;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new r:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){l=n[o].listener,s=o;break}if(s<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new r,this;delete i[e]}else!function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(n,s);i.removeListener&&this.emit("removeListener",e,l||t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new r,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new r:delete n[e]),this;if(0===arguments.length){for(var i,s=Object.keys(n),o=0;o<s.length;++o)"removeListener"!==(i=s[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new r,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},n.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):[]},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):c.call(e,t)},n.prototype.listenerCount=c,n.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};class d extends n{constructor(e,t){super(),this.value=e,this.dep=[],this.dataProxy=t}setDep(e){this.dep.push(e)}valueOf(){return this.value}toString(){return this.value}set(e){this.value=e}get(){return this.value}notify(){this.dep.forEach((e=>{e.update()})),this.emit("change",this.value)}}class y{constructor(e){this.fn=e}update(){this.fn()}}class v{constructor(){this.valueMap=new WeakMap}getProp(e,t){this.valueMap.get(e)||this.valueMap.set(e,{});let r=this.valueMap.get(e);if(!r[t]){let n=new d(Array.isArray(e[t])?new Proxy(e[t],{set(e,t,r,i){let s=Reflect.set(e,t,r,i);return n.notify(),s}}):e[t]);r[t]=n}return r[t]}getValueTarget(e){return this.valueMap.get(e)}setValueTarget(e,t){this.valueMap.set(e,t)}}class g{constructor(e){this.dataProxyValue=new v;const t={get:(e,r,n)=>{if("object"!=typeof e[r]||null===e[r]||Array.isArray(e[r])){if("function"==typeof e[r])return Reflect.get(e,r,n);{let t=this.dataProxyValue.getProp(e,r);for(let e of _.depPool)e.includes(t)||e.push(t);return t.value}}return new Proxy(e[r],t)},set:(e,t,r,n)=>{if("object"!=typeof r||null===r||Array.isArray(r)){let i=this.dataProxyValue.getProp(e,t);i.value=Array.isArray(r)?new Proxy(r,{set(e,t,r,n){let s=Reflect.set(e,t,r,n);return i.notify(),s}}):r;let s=Reflect.set(e,t,r,n);return i.notify(),s}{let i=this.dataProxyValue.getValueTarget(e[t]),s=Reflect.set(e,t,r,n);return this.replaceProps(r,i),s}}};this.data=new Proxy(e,t)}replaceProps(e,t){for(let r in t){let n=t[r];n.value=e[r],n.notify()}this.dataProxyValue.setValueTarget(e,t)}getData(){return this.data}}class m{constructor(e){this.dataProxyValue=new v;const t={get:(e,r,n)=>{if("object"!=typeof e[r]||null===e[r]||Array.isArray(e[r])){if("function"==typeof e[r])return Reflect.get(e,r,n);{let t=this.dataProxyValue.getProp(e,r);for(let e of _.depPool)e.includes(t)||e.push(t);return t.value}}return new Proxy(e[r],t)},set:(e,t,r,n)=>{if("object"!=typeof r||null===r||Array.isArray(r)){let i=this.dataProxyValue.getProp(e,t);i.value=Array.isArray(r)?new Proxy(r,{set(e,t,r,n){let s=Reflect.set(e,t,r,n);return i.notify(),s}}):r;let s=Reflect.set(e,t,r,n);return i.notify(),s}{let i=this.dataProxyValue.getValueTarget(e[t]),s=Reflect.set(e,t,r,n);return this.replaceProps(r,i),s}}};this.data=new Proxy(e,t)}getData(){return this.data}replaceProps(e,t){for(let r in t){let n=t[r];n.value=e[r],n.notify()}this.dataProxyValue.setValueTarget(e,t)}}class w{constructor(e={}){this.config=e,this.setData()}setData(){this.data=new m(this.config.data||{}).getData()}setProps(e){this.props=e}setChildren(e){this.children=e}renderRoot(){return this.render(L)}}class x{}x.ELEMENT=0,x.TEXT=1,x.COMPONENT=2;class C extends x{constructor(e){super(),this.type=x.TEXT,this.text=e}createTextNode(){return this.textNode=document.createTextNode(this.text),this.textNode}}class E extends x{constructor(e,t,r){super(),this.type=x.COMPONENT,this.Constructor=e,this.props=t||{},this.children=r||[]}init(){let e=new m({}).getData();for(let t in this.props){if("function"!=typeof this.props[t]){e[t]=this.props[t];continue}let r=[],n=_.depPool;n.push(r);let i=this.props[t]();if(n.splice(n.indexOf(r),1),"function"==typeof i)e[t]=i;else{e[t]=i;let n=()=>e[t]=this.props[t]();r.forEach((e=>{e.setDep(new y(n))}))}}let t=new g([]).getData();if(this.children)for(let e=0;e<this.children.length;e++){if("function"!=typeof this.children[e]){t[e]=this.children[e];continue}let r=[],n=_.depPool;n.push(r);let i=this.children[e]();if(n.splice(n.indexOf(r),1),"function"==typeof i)t[e]=i;else{t[e]=i;let n=()=>t[e]=this.children[e]();r.forEach((e=>{e.setDep(new y(n))}))}}let r=this.Constructor;this.component=new r(e,t),this.component.setProps(e),this.component.setChildren(t)}getComponent(){return this.init(),this.component}}class P extends x{constructor(e,t,r){super(),this.type=x.ELEMENT,this.tag=e,this.props=t,this.children=r}createEle(){var e;if(this.ele=document.createElement(this.tag),this.props)for(let t in this.props)if("function"==typeof this.props[t]){let r=[],n=_.depPool;n.push(r);let i=this.props[t]();if(n.splice(n.indexOf(r),1),"function"==typeof i){let e=/^on([a-zA-Z]+)/;if(e.test(t)){let r=t.match(e);r&&this.ele.addEventListener(r[1].toLocaleLowerCase(),i.bind(this.ele))}else this.ele.addEventListener(t,i.bind(this.ele))}else{null===(e=this.ele)||void 0===e||e.setAttribute(t,i);let n=()=>{var e;return null===(e=this.ele)||void 0===e?void 0:e.setAttribute(t,this.props[t]())};r.forEach((e=>{e.setDep(new y(n))}))}}else this.ele.setAttribute(t,this.props[t]);if(Array.isArray(this.children)&&this.children.length)for(let e of this.children)this.addChild(e);else void 0!==this.children&&null!==this.children&&this.addChild(this.children);return this.ele}getRealNode(e){let t=document.createTextNode("");if("string"==typeof e){t=new C(e).createTextNode()}else if(e instanceof w)t=e.renderRoot().createEle();else if(e instanceof E)t=e.getComponent().renderRoot().createEle();else if(e instanceof P)t=e.createEle();else if(e instanceof C)t=e.createTextNode();else{t=new C(String(e)).createTextNode()}return t}getRealNodeList(e){let t=[];for(let r of e)t.push(this.getRealNode(r));return t}addChildren(e,t){var r;let n=document.createDocumentFragment();for(let t of e)n.appendChild(t);null===(r=this.ele)||void 0===r||r.insertBefore(n,t)}removeChildren(e){for(let t of e)t.remove()}addChild(e){if(this.ele)if("string"==typeof e){let t=new C(e);this.ele.appendChild(t.createTextNode())}else if(e instanceof w)this.ele.appendChild(e.renderRoot().createEle());else if(e instanceof E)this.ele.appendChild(e.getComponent().renderRoot().createEle());else if(e instanceof P)this.ele.appendChild(e.createEle());else if(e instanceof C)this.ele.appendChild(e.createTextNode());else if("function"==typeof e){let t=[],r=_.depPool;r.push(t);let n=e();if(r.splice(r.indexOf(t),1),Array.isArray(n)){let r=document.createTextNode("");this.ele.appendChild(r);let i=this.getRealNodeList(n);if(this.addChildren(i,r),!t.length)return;let s=()=>{this.removeChildren(i);let t=e();Array.isArray(t)&&(i=this.getRealNodeList(t),this.addChildren(i,r))};for(let e of t)e.setDep(new y(s))}else{let r=this.getRealNode(n);if(this.ele.appendChild(r),!t.length)return;let i=()=>{var t,n;let i=e(),s=this.getRealNode(i);s?s.nodeType===r.nodeType?r.nodeValue=s.nodeValue:(null===(t=this.ele)||void 0===t||t.replaceChild(s,r),r=s):null===(n=this.ele)||void 0===n||n.replaceChild(r=document.createTextNode(""),r)};for(let e of t)e.setDep(new y(i))}}else if(Array.isArray(e))for(let t of e)this.addChild(t);else{let t=new C(String(e));this.ele.appendChild(t.createTextNode())}}}function L(e,t,r){if("string"==typeof e)return new P(e,t,r);if("function"==typeof e)return new E(e,t,r);throw new Error("只能传入字符串或者构造函数")}P.nativeEvents={onClick:"click"};class _{static getDepPool(){return this.depPool}}_.depPool=[],_.Component=w,_.mount=function(e,t){let r=document.querySelector(e),n=t.renderRoot().createEle();r&&n&&r.parentNode&&r.parentNode.replaceChild(n,r)},_.createNode=L;const N=_.mount,T=_.Component,A=_.createNode;exports.Component=T,exports.createNode=A,exports.default=_,exports.mount=N;
//# sourceMappingURL=boundle.js.map
