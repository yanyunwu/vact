{"version":3,"file":"bundle.esm.js","sources":["../src/vnode/vnode.ts","../src/patch.ts","../src/vnode/fragment.ts","../src/vnode/text.ts","../src/vnode/array.ts","../src/utils.ts","../src/reactive/reactive.ts","../src/reactive/active.ts","../src/render.ts","../src/reactive/watch.ts","../src/mount.ts","../src/reactive/ref.ts","../src/reactive/utils.ts","../src/component.ts","../src/vact.ts"],"sourcesContent":["import { Activer } from \"../reactive\"\r\nimport { Component } from './component'\r\n\r\n/**\r\n * 虚拟dom节点类型枚举\r\n*/\r\nexport enum VNODE_TYPE {\r\n  // 普通元素节点类型\r\n  ELEMENT,\r\n  // 文本节点类型\r\n  TEXT,\r\n  FRAGMENT,\r\n  COMPONENT,\r\n  ARRAYNODE\r\n}\r\n\r\n/**\r\n * 虚拟dom接口类型\r\n*/\r\nexport interface VNode {\r\n\r\n  // 虚拟节点类型\r\n  type: string | symbol | Component,\r\n\r\n  // 虚拟节点属性\r\n  props?: Record<string, any> | null,\r\n\r\n  // 虚拟节点子节点\r\n  children?: Array<Activer | VNode | string> | string,\r\n\r\n  // 虚拟节点表标识\r\n  flag: VNODE_TYPE\r\n\r\n  // 真实节点\r\n  el?: HTMLElement | Text\r\n\r\n}\r\n\r\n","import { unmount, mount, setElementProp } from \"./mount\";\r\nimport { VText } from \"./vnode/text\";\r\nimport { VNode, VNODE_TYPE } from \"./vnode/vnode\";\r\n\r\nexport function isSameVNode(oldVNode: VNode, newVNode: VNode): boolean {\r\n  return oldVNode.flag === newVNode.flag\r\n}\r\n\r\nexport function patch(oldVNode: VNode, newVNode: VNode, container: HTMLElement): void {\r\n\r\n  // 如果两个节点引用一样不需要判断\r\n  if (oldVNode === newVNode) return\r\n\r\n  // 这里在判断相同类型的节点后可以做进一步优化\r\n  if (isSameVNode(oldVNode, newVNode)) {\r\n    if (oldVNode.flag === VNODE_TYPE.TEXT) {\r\n      patchText(<VText>oldVNode, <VText>newVNode, container)\r\n    } else {\r\n      const nextSibling = oldVNode?.el?.nextSibling\r\n      unmount(oldVNode, container)\r\n      mount(newVNode, container, nextSibling as HTMLElement | undefined)\r\n    }\r\n  } else {\r\n    const nextSibling = oldVNode?.el?.nextSibling\r\n    unmount(oldVNode, container)\r\n    mount(newVNode, container, nextSibling as HTMLElement | undefined)\r\n  }\r\n\r\n}\r\n\r\nexport function patchElement() {\r\n\r\n}\r\n\r\n\r\nexport function patchText(oldVNode: VText, newVNode: VText, container: HTMLElement) {\r\n  oldVNode.el!.nodeValue = newVNode.children\r\n  newVNode.el = oldVNode.el\r\n}\r\n\r\nexport function patchArrayNode(oldVNode: VNode, newVNode: VNode) {\r\n\r\n}\r\n\r\n\r\nexport function patchElementProp(oldValue: any, newValue: any, el: HTMLElement, prop: string) {\r\n  setElementProp(el, prop, newValue)\r\n}","\r\n\r\nexport const Fragment = Symbol('Fragment');\r\n\r\nimport { Activer } from \"../reactive\";\r\nimport { VNode, VNODE_TYPE } from \"./vnode\";\r\n\r\n\r\nexport interface VFragment extends VNode {\r\n\r\n  // 虚拟节点类型\r\n  type: symbol,\r\n\r\n  // 虚拟节点属性\r\n  props: null,\r\n\r\n  // 虚拟节点子节点\r\n  children: Array<Activer | VNode | string>,\r\n\r\n  // 虚拟节点表标识\r\n  flag: VNODE_TYPE.FRAGMENT\r\n\r\n  // 锚点\r\n  anchor: Text,\r\n  el: Text\r\n\r\n}","import { VNode, VNODE_TYPE } from \"./vnode\";\r\n\r\n\r\nexport const Text = Symbol('Text');\r\n\r\nexport interface VText extends VNode {\r\n\r\n  // 虚拟节点类型\r\n  type: symbol,\r\n\r\n  // 虚拟节点属性\r\n  props?: null,\r\n\r\n  // 虚拟节点子节点\r\n  children: string,\r\n\r\n  // 虚拟节点表标识\r\n  flag: VNODE_TYPE.TEXT\r\n\r\n  el?: Text\r\n\r\n}","export const ArrayNode = Symbol('ArrayNode');\r\n\r\nimport { Activer } from \"../reactive\";\r\nimport { VNode, VNODE_TYPE } from \"./vnode\";\r\n\r\n\r\nexport interface VArrayNode extends VNode {\r\n\r\n  // 虚拟节点类型\r\n  type: symbol,\r\n\r\n  // 虚拟节点属性\r\n  props: null,\r\n\r\n  // 虚拟节点子节点\r\n  children: Array<Activer | VNode | string>,\r\n\r\n  // 虚拟节点表标识\r\n  flag: VNODE_TYPE.ARRAYNODE\r\n\r\n  // 锚点\r\n  anchor: Text,\r\n  el: Text\r\n}","import { VNode, VNODE_TYPE } from './vnode/vnode'\r\nimport { Activer } from './reactive/active'\r\nimport { Fragment } from './vnode/fragment'\r\nimport { Text } from './vnode/text'\r\nimport { ArrayNode } from './vnode/array'\r\n\r\nexport function isString(content: unknown): content is string {\r\n  return typeof content === 'string'\r\n}\r\n\r\nexport function isFunction(content: unknown): content is Function {\r\n  return typeof content === 'function'\r\n}\r\n\r\nexport function isFragment(content: unknown): boolean {\r\n  return content === Fragment\r\n}\r\n\r\nexport function isArrayNode(content: unknown): boolean {\r\n  return content === ArrayNode\r\n}\r\n\r\nexport function isText(content: unknown): boolean {\r\n  return content === Text\r\n}\r\n\r\nexport function isActiver(content: unknown): content is Activer {\r\n  return isObject(content) && (content as Record<any, any>).flag === 'activer'\r\n}\r\n\r\nexport function isVNode(content: unknown): content is VNode {\r\n  return isObject(content) && (content as Record<any, any>).flag in VNODE_TYPE\r\n}\r\n\r\nexport function isObjectExact(content: unknown): content is Object {\r\n  return isObject(content) && content.constructor === Object\r\n}\r\n\r\nexport function isOnEvent(str: string): boolean {\r\n  return /^on.+$/.test(str)\r\n}\r\n\r\nexport function isObject(content: unknown): content is object {\r\n  return typeof content === 'object' && content !== null\r\n}\r\n\r\n\r\nexport function isArray(content: unknown): content is Array<any> {\r\n  return Array.isArray(content)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { isObjectExact, isVNode } from \"../utils\"\r\nimport { Watcher } from \"./watch\"\r\n\r\n// 目标对象到映射对象\r\nconst targetMap = new WeakMap()\r\n// 全局变量watcher\r\nlet activeWatcher: Watcher | null = null\r\nconst REACTIVE = Symbol('reactive')\r\n\r\n/**\r\n * 实现响应式对象\r\n*/\r\nexport function reactive<T extends Record<string | symbol, any>>(target: T): T {\r\n  if (target[REACTIVE]) return target\r\n\r\n  let handler: ProxyHandler<T> = {\r\n    get(target, prop, receiver) {\r\n      if (prop === REACTIVE) return true\r\n      const res = Reflect.get(target, prop, receiver)\r\n\r\n      if (isObjectExact(res) && !isVNode(res)) {\r\n        return reactive(res)\r\n      }\r\n\r\n      if (Array.isArray(res)) {\r\n        track(target, prop)\r\n        return reactiveArray(res, target, prop)\r\n      }\r\n\r\n      track(target, prop)\r\n      return res\r\n    },\r\n\r\n    set(target, prop, value, receiver) {\r\n      const oldValue = Reflect.get(target, prop, receiver)\r\n      const res = Reflect.set(target, prop, value, receiver)\r\n      const newValue = Reflect.get(target, prop, receiver)\r\n      trigger(target, prop, oldValue, newValue)\r\n      return res\r\n    }\r\n  }\r\n\r\n  return new Proxy(target, handler)\r\n}\r\n\r\n/**\r\n * 设置响应式数组\r\n*/\r\nfunction reactiveArray(targetArr: Array<any>, targetObj: Record<any, any>, Arrprop: string | symbol) {\r\n  let handler: ProxyHandler<Record<any, any>> = {\r\n    get(target, prop, receiver) {\r\n      const res = Reflect.get(target, prop, receiver)\r\n\r\n      if (isObjectExact(res)) {\r\n        return reactive(res)\r\n      }\r\n\r\n      return res\r\n    },\r\n    set(target, prop, value, receiver) {\r\n      const res = Reflect.set(target, prop, value, receiver)\r\n      trigger(targetObj, Arrprop)\r\n      return res\r\n    }\r\n  }\r\n\r\n  return new Proxy(targetArr, handler)\r\n}\r\n\r\n/**\r\n * 响应触发依赖\r\n*/\r\nexport function trigger(target: Record<any, any>, prop: string | symbol, oldValue?: any, newValue?: any) {\r\n  let mapping: Record<string | symbol, Array<Watcher>> = targetMap.get(target)\r\n  if (!mapping) return\r\n\r\n  let mappingProp: Array<Watcher> = mapping[prop]\r\n  if (!mappingProp) return\r\n\r\n  mappingProp.forEach(watcher => watcher.update(oldValue, newValue))\r\n}\r\n\r\n/**\r\n * 追踪绑定依赖\r\n*/\r\nexport function track(target: Record<any, any>, prop: string | symbol) {\r\n  if (!activeWatcher) return\r\n\r\n  let mapping: Record<string | symbol, Array<Watcher>> = targetMap.get(target)\r\n  if (!mapping) targetMap.set(target, mapping = {})\r\n\r\n  let mappingProp: Array<Watcher> = mapping[prop]\r\n  if (!mappingProp) mappingProp = mapping[prop] = []\r\n\r\n  mappingProp.push(activeWatcher)\r\n}\r\n\r\n// 设置全局变量\r\nexport function setActiver(fn: Watcher | null) {\r\n  activeWatcher = fn\r\n}\r\n// 设置全局变量\r\nexport function getActiver(): Watcher | null {\r\n  return activeWatcher\r\n}\r\n\r\n","\r\n/**\r\n * 响应式对象\r\n*/\r\nexport class Activer<T = any> {\r\n  callback: () => T\r\n  flag: string = 'activer'\r\n\r\n  constructor(fn: () => T) {\r\n    this.callback = fn\r\n  }\r\n\r\n  get value(): T {\r\n    return this.callback()\r\n  }\r\n}\r\n\r\n/**\r\n * 外置函数\r\n*/\r\nexport function active<T extends any>(fn: () => T): Activer<T> {\r\n  return new Activer(fn)\r\n}\r\n\r\n","import { active } from \"./reactive/active\";\r\nimport { Activer } from './reactive'\r\nimport { isString, isFragment, isText, isFunction, isArrayNode, isOnEvent, isVNode, isActiver } from \"./utils\";\r\nimport { Component } from \"./vnode/component\";\r\nimport { VNode, VNODE_TYPE } from \"./vnode/vnode\";\r\n\r\n/**\r\n * 传说中的render函数\r\n*/\r\nexport type ComponentConstructor = new (props: Record<string, any>, children: Array<any> | string) => Component | VNode\r\nexport type H = (type: string | symbol | ComponentConstructor, props?: Record<string, any> | null, children?: Array<any> | string) => VNode\r\nexport function render(type: string | symbol | ComponentConstructor, props?: Record<string, any> | null, children?: Array<any> | string): VNode {\r\n\r\n  // 预处理 处理为单个的children\r\n  if (!isText(type) && !Array.isArray(children)) {\r\n    children = [children]\r\n  }\r\n\r\n  // 子元素预处理 \r\n  if (children && Array.isArray(children)) {\r\n    children = children.map(child => isFunction(child) ? active(child) : child)\r\n  }\r\n\r\n  // 属性预处理\r\n  if (props) {\r\n    for (const prop in props) {\r\n      // 以on开头的事件不需要处理\r\n      if (!isOnEvent(prop) && isFunction(props[prop])) {\r\n        props[prop] = active(props[prop])\r\n      }\r\n    }\r\n  }\r\n\r\n  let flag: VNODE_TYPE\r\n\r\n  if (isString(type)) {\r\n    flag = VNODE_TYPE.ELEMENT\r\n  } else if (isFragment(type)) {\r\n    flag = VNODE_TYPE.FRAGMENT\r\n  } else if (isText(type)) {\r\n    flag = VNODE_TYPE.TEXT\r\n  } else if (isArrayNode(type)) {\r\n    flag = VNODE_TYPE.ARRAYNODE\r\n  } else if (isFunction(type)) {\r\n    return renderComponent(type, props || {}, children as [] || [])\r\n  } else {\r\n    throw '传入参数不合法'\r\n  }\r\n\r\n  return {\r\n    type: <string | symbol>type,\r\n    props,\r\n    children,\r\n    flag\r\n  }\r\n}\r\n\r\n// 判断是普通函数还是构造函数\r\nfunction renderComponent(component: ComponentConstructor, props: Record<string, any>, children: Array<Activer | VNode | string>): VNode {\r\n  let cprops: Record<string, any> = {}\r\n  for (let prop in props) {\r\n    let cur = props[prop]\r\n    if (isActiver(cur)) {\r\n      Object.defineProperty(cprops, prop, {\r\n        get() {\r\n          return (<Activer>cur).value\r\n        }\r\n      })\r\n    } else {\r\n      cprops[prop] = cur\r\n    }\r\n  }\r\n\r\n\r\n  let result = new component(cprops, children)\r\n  if (isVNode(result)) {\r\n    return result\r\n  } else {\r\n    result.props = cprops\r\n    result.children = children\r\n    return {\r\n      type: result,\r\n      props,\r\n      children,\r\n      flag: VNODE_TYPE.COMPONENT\r\n    }\r\n  }\r\n}","import { setActiver } from \"./reactive\"\r\nimport { active, Activer } from './active'\r\nimport { VNode } from \"../vnode/vnode\"\r\nimport { isActiver, isVNode } from \"../utils\"\r\nimport { render } from \"../render\"\r\nimport { Text } from '../vnode/text'\r\nimport { ArrayNode } from \"../vnode/array\"\r\n\r\n/**\r\n * 观察者\r\n * 观察数据的变化\r\n*/\r\nexport class Watcher<T = any> {\r\n  value: T\r\n  callback: (oldValue: T, newValue: T) => void\r\n  activeProps: Activer<T>\r\n\r\n  constructor(activeProps: Activer<T>, callback: (oldValue: T, newValue: T) => void) {\r\n    setActiver(this)\r\n    this.value = activeProps.value\r\n    this.callback = callback\r\n    this.activeProps = activeProps\r\n    setActiver(null)\r\n  }\r\n\r\n  update(targetPropOldValue: any, targetPropnewValue: any) {\r\n    let newValue = this.activeProps.value\r\n    let oldValue = this.value\r\n    this.value = newValue\r\n    this.callback(oldValue, newValue)\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * 监控自定义响应式属性\r\n*/\r\nexport function watch<T = any>(activeProps: (() => T) | Activer<T>, callback: (oldValue: T, newValue: T) => void): Watcher<T> {\r\n  if (!isActiver(activeProps)) activeProps = active(activeProps)\r\n  return new Watcher<T>(activeProps, function (oldValue: T, newValue: T) {\r\n    callback(oldValue, newValue)\r\n  })\r\n}\r\n\r\n/**\r\n * 监控可变状态dom\r\n*/\r\nexport type RowChildType = VNode | null | Array<VNode>\r\nexport function watchVNode(activeVNode: Activer<RowChildType>, callback: (oldVNode: VNode, newVNode: VNode) => void): VNode {\r\n  let watcher = new Watcher<RowChildType>(activeVNode, function (oldVNode: RowChildType, newVNode: RowChildType) {\r\n    if (!isVNode(newVNode)) {\r\n      if (!newVNode && typeof newVNode !== 'number') newVNode = render(Text, null, '')\r\n      else if (Array.isArray(newVNode)) {\r\n        newVNode = render(ArrayNode, null, newVNode)\r\n      } else {\r\n        newVNode = render(Text, null, String(newVNode))\r\n      }\r\n    }\r\n    callback(oldVNode as VNode, newVNode)\r\n    watcher.value = newVNode\r\n  })\r\n\r\n  if (isVNode(watcher.value)) return watcher.value\r\n\r\n  if (!watcher.value && typeof watcher.value !== 'number') watcher.value = render(Text, null, '')\r\n  else if (Array.isArray(watcher.value)) {\r\n    watcher.value = render(ArrayNode, null, watcher.value)\r\n  } else {\r\n    watcher.value = render(Text, null, String(watcher.value))\r\n  }\r\n  return watcher.value\r\n}\r\n\r\n\r\n/**\r\n * 监控可变dom的prop\r\n*/\r\nexport function watchProp(activeProp: Activer, callback: (oldVNode: VNode, newVNode: VNode) => void): any {\r\n  return new Watcher(activeProp, callback).value\r\n}","import { patch, patchElementProp } from \"./patch\";\r\nimport { Activer } from \"./reactive/active\";\r\nimport { watchProp, watchVNode } from \"./reactive/watch\";\r\nimport { render } from \"./render\";\r\nimport { isActiver, isArray, isFunction, isObject, isOnEvent, isVNode } from \"./utils\";\r\nimport { VArrayNode } from \"./vnode/array\";\r\nimport { VComponent } from \"./vnode/component\";\r\nimport { VElement } from \"./vnode/element\";\r\nimport { VFragment } from \"./vnode/fragment\";\r\nimport { Text, VText } from './vnode/text'\r\nimport { VNode, VNODE_TYPE } from \"./vnode/vnode\";\r\n\r\n\r\nexport function mount(vnode: VNode, container: HTMLElement, anchor?: HTMLElement) {\r\n  switch (vnode.flag) {\r\n    case VNODE_TYPE.ELEMENT:\r\n      mountElement(vnode as VElement, container, anchor)\r\n      break\r\n    case VNODE_TYPE.TEXT:\r\n      mountText(vnode as VText, container, anchor)\r\n      break\r\n    case VNODE_TYPE.FRAGMENT:\r\n      mountFragment(vnode as VFragment, container, anchor)\r\n      break\r\n    case VNODE_TYPE.ARRAYNODE:\r\n      mountArrayNode(vnode as VArrayNode, container, anchor)\r\n      break\r\n    case VNODE_TYPE.COMPONENT:\r\n      mountComponent(vnode as VComponent, container, anchor)\r\n      break\r\n  }\r\n}\r\n\r\nexport function unmount(vnode: VNode, container: HTMLElement) {\r\n  switch (vnode.flag) {\r\n    case VNODE_TYPE.ELEMENT:\r\n      unmountElement(vnode as VElement, container)\r\n      break\r\n    case VNODE_TYPE.TEXT:\r\n      unmountText(vnode as VText, container)\r\n      break\r\n    case VNODE_TYPE.FRAGMENT:\r\n      unmountFragment(vnode as VFragment, container)\r\n      break\r\n    case VNODE_TYPE.ARRAYNODE:\r\n      unmountArrayNode(vnode as VArrayNode, container)\r\n      break\r\n    case VNODE_TYPE.COMPONENT:\r\n      unmountComponent(vnode as VComponent, container)\r\n      break\r\n  }\r\n}\r\n\r\nexport function mountChildren(children: Array<Activer | VNode | string>, container: HTMLElement, anchor?: HTMLElement) {\r\n  children.forEach(child => {\r\n    if (isActiver(child)) {\r\n      let firstVNode = watchVNode(child, (oldVNode, newVNode) => patch(oldVNode, newVNode, container))\r\n      mount(firstVNode, container, anchor)\r\n    } else if (isVNode(child)) {\r\n      mount(child, container, anchor)\r\n    } else if (isArray(child)) {\r\n      mountChildren(child, container, anchor)\r\n    } else {\r\n      mount(render(Text, null, child || typeof child === 'number' ? String(child) : ''), container, anchor)\r\n    }\r\n  })\r\n}\r\n\r\nexport function mountElement(vnode: VElement, container: HTMLElement, anchor?: HTMLElement) {\r\n  const el = document.createElement(vnode.type)\r\n  vnode.el = el\r\n  mountElementProps(vnode)\r\n  mountChildren(vnode.children, el)\r\n  container.insertBefore(el, anchor!)\r\n}\r\n\r\nexport function unmountElement(vnode: VElement, container: HTMLElement) {\r\n  vnode.el?.remove()\r\n}\r\n\r\nexport function mountText(vnode: VText, container: HTMLElement, anchor?: HTMLElement) {\r\n  const el = document.createTextNode(vnode.children)\r\n  vnode.el = el\r\n  container.insertBefore(el, anchor!)\r\n}\r\n\r\nexport function unmountText(vnode: VText, container: HTMLElement) {\r\n  vnode.el?.remove()\r\n}\r\n\r\nexport function mountFragment(vnode: VFragment, container: HTMLElement, anchor?: HTMLElement) {\r\n  const start = document.createTextNode('')\r\n  const end = document.createTextNode('')\r\n  vnode.anchor = start\r\n  vnode.el = end\r\n  container.insertBefore(start, anchor!)\r\n  mountChildren(vnode.children, container, anchor)\r\n  container.insertBefore(end, anchor!)\r\n}\r\n\r\nexport function unmountFragment(vnode: VFragment, container: HTMLElement) {\r\n  const start = vnode.anchor\r\n  const end = vnode.el\r\n  let cur: ChildNode | null = start\r\n  while (cur && cur !== end) {\r\n    let next: ChildNode | null = cur.nextSibling\r\n    cur.remove()\r\n    cur = next\r\n  }\r\n  end.remove()\r\n}\r\n\r\nexport function mountArrayNode(vnode: VArrayNode, container: HTMLElement, anchor?: HTMLElement) {\r\n  const start = document.createTextNode('')\r\n  const end = document.createTextNode('')\r\n  vnode.anchor = start\r\n  vnode.el = end\r\n  container.insertBefore(start, anchor!)\r\n  mountChildren(vnode.children, container, anchor)\r\n  container.insertBefore(end, anchor!)\r\n}\r\n\r\nexport function unmountArrayNode(vnode: VArrayNode, container: HTMLElement, anchor?: HTMLElement) {\r\n  const start = vnode.anchor\r\n  const end = vnode.el\r\n  let cur: ChildNode | null = start\r\n  while (cur && cur !== end) {\r\n    let next: ChildNode | null = cur.nextSibling\r\n    cur.remove()\r\n    cur = next\r\n  }\r\n  end.remove()\r\n}\r\n\r\n\r\nexport function mountElementProps(vnode: VElement) {\r\n  let el = vnode.el!\r\n  let props = vnode.props\r\n\r\n  // 处理标签属性\r\n  for (let prop in props) {\r\n    let value = props[prop]\r\n    if (isActiver(value)) {\r\n      let firstValue = watchProp(value, (oldValue, newValue) => patchElementProp(oldValue, newValue, el, prop))\r\n      setElementProp(el, prop, firstValue)\r\n    } else {\r\n      setElementProp(el, prop, value)\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * 处理单个dom属性\r\n*/\r\nexport function setElementProp(el: HTMLElement, prop: string, value: any) {\r\n  if (isOnEvent(prop) && isFunction(value)) {\r\n    let pattern = /^on(.+)$/\r\n    let result = prop.match(pattern)\r\n    result && el.addEventListener(result[1].toLocaleLowerCase(), value.bind(el))\r\n    return\r\n  }\r\n\r\n  switch (prop) {\r\n    case 'className':\r\n      el.className = String(value)\r\n      break\r\n    case 'style':\r\n      if (isObject(value)) {\r\n        value = mergeStyle(value)\r\n      }\r\n    default:\r\n      el.setAttribute(prop, value)\r\n  }\r\n}\r\n\r\n/**\r\n * 将对象形式的style转化为字符串\r\n*/\r\nfunction mergeStyle(style: Record<any, any>): string {\r\n  let styleStringList = []\r\n  for (let cssAttr in style) {\r\n    styleStringList.push(`${cssAttr}:${style[cssAttr]};`)\r\n  }\r\n  return styleStringList.join('')\r\n}\r\n\r\nexport function mountComponent(vnode: VComponent, container: HTMLElement, anchor?: HTMLElement) {\r\n  const root = vnode.type.render(render)\r\n  vnode.root = root\r\n  mount(root, container, anchor)\r\n  vnode.el = root.el!\r\n}\r\n\r\nexport function unmountComponent(vnode: VComponent, container: HTMLElement) {\r\n  unmount(vnode.root, container)\r\n}","import { track, trigger } from './reactive'\r\n\r\nexport class RefImpl<T = any> {\r\n  private _value: T\r\n\r\n  constructor(value: T) {\r\n    this._value = value\r\n  }\r\n\r\n  get value() {\r\n    track(this, 'value')\r\n    return this._value\r\n  }\r\n\r\n  set value(value) {\r\n    this._value = value\r\n    trigger(this, 'value')\r\n  }\r\n}\r\n\r\n\r\nexport function ref<T extends any>(value: T): RefImpl<T> {\r\n  return new RefImpl(value)\r\n}","import { ref } from './ref'\r\nimport { reactive } from './reactive'\r\n\r\n\r\nexport function state<T extends any>(value: T) {\r\n  return ref(value)\r\n}\r\n\r\nexport function defineState<T extends Record<string | symbol, any>>(target: T): T {\r\n  return reactive(target)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n","import { defineState } from \"./reactive\"\r\nimport { H } from './render'\r\nimport { VNode } from \"./vnode/vnode\"\r\n\r\n/**\r\n * 根类组件(向下兼容)\r\n * 已废弃\r\n*/\r\n\r\ninterface Config {\r\n  data?: Record<string | symbol, any>\r\n}\r\n\r\nexport abstract class Component {\r\n  // 组件配置\r\n  private config: Config\r\n  // 组件响应式数据\r\n  public data: Record<any, any>\r\n  // 组件属性\r\n  props?: Record<any, any>\r\n  // 组件子元素\r\n  children?: Record<string, any>\r\n\r\n  constructor(config: Config = {}) {\r\n    this.config = config\r\n    this.data = defineState(config.data || {})\r\n  }\r\n\r\n  abstract render(h: H): VNode\r\n}","import { mount } from \"./mount\";\r\nimport { VNode } from \"./vnode/vnode\";\r\n\r\n\r\nexport class Vact {\r\n  rootVNode: VNode\r\n\r\n  constructor(vnode: VNode, options?: Record<string, any>) {\r\n    this.rootVNode = vnode\r\n  }\r\n\r\n  mount(selector: string): void {\r\n    const el = document.querySelector(selector)\r\n    let container = document.createElement('div')\r\n    mount(this.rootVNode, container)\r\n    el?.replaceWith(...container.childNodes)\r\n  }\r\n}\r\n\r\nexport function createApp(vnode: VNode, options?: Record<string, any>): Vact {\r\n  return new Vact(vnode, options)\r\n}\r\n\r\n"],"names":[],"mappings":"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"}