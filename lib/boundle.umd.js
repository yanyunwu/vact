!function(e,t){e&&!e.getElementById("livereloadscript")&&((t=e.createElement("script")).async=1,t.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",t.id="livereloadscript",e.getElementsByTagName("head")[0].appendChild(t))}(self.document),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Vact={})}(this,(function(e){"use strict";function t(){}function n(){n.init.call(this)}function i(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function r(e,t,n){if(t)e.call(n);else for(var i=e.length,r=p(e,i),s=0;s<i;++s)r[s].call(n)}function s(e,t,n,i){if(t)e.call(n,i);else for(var r=e.length,s=p(e,r),o=0;o<r;++o)s[o].call(n,i)}function o(e,t,n,i,r){if(t)e.call(n,i,r);else for(var s=e.length,o=p(e,s),l=0;l<s;++l)o[l].call(n,i,r)}function l(e,t,n,i,r,s){if(t)e.call(n,i,r,s);else for(var o=e.length,l=p(e,o),a=0;a<o;++a)l[a].call(n,i,r,s)}function a(e,t,n,i){if(t)e.apply(n,i);else for(var r=e.length,s=p(e,r),o=0;o<r;++o)s[o].apply(n,i)}function h(e,n,r,s){var o,l,a,h;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((l=e._events)?(l.newListener&&(e.emit("newListener",n,r.listener?r.listener:r),l=e._events),a=l[n]):(l=e._events=new t,e._eventsCount=0),a){if("function"==typeof a?a=l[n]=s?[r,a]:[a,r]:s?a.unshift(r):a.push(r),!a.warned&&(o=i(e))&&o>0&&a.length>o){a.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+n+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=e,f.type=n,f.count=a.length,h=f,"function"==typeof console.warn?console.warn(h):console.log(h)}}else a=l[n]=r,++e._eventsCount;return e}function f(e,t,n){var i=!1;function r(){e.removeListener(t,r),i||(i=!0,n.apply(e,arguments))}return r.listener=n,r}function c(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function p(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}t.prototype=Object.create(null),n.EventEmitter=n,n.usingDomains=!1,n.prototype.domain=void 0,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.init=function(){this.domain=null,n.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new t,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return i(this)},n.prototype.emit=function(e){var t,n,i,h,f,c,p,u="error"===e;if(c=this._events)u=u&&null==c.error;else if(!u)return!1;if(p=this.domain,u){if(t=arguments[1],!p){if(t instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=p,t.domainThrown=!1,p.emit("error",t),!1}if(!(n=c[e]))return!1;var v="function"==typeof n;switch(i=arguments.length){case 1:r(n,v,this);break;case 2:s(n,v,this,arguments[1]);break;case 3:o(n,v,this,arguments[1],arguments[2]);break;case 4:l(n,v,this,arguments[1],arguments[2],arguments[3]);break;default:for(h=new Array(i-1),f=1;f<i;f++)h[f-1]=arguments[f];a(n,v,this,h)}return!0},n.prototype.addListener=function(e,t){return h(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return h(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,f(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,f(this,e,t)),this},n.prototype.removeListener=function(e,n){var i,r,s,o,l;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(i=r[e]))return this;if(i===n||i.listener&&i.listener===n)0==--this._eventsCount?this._events=new t:(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if("function"!=typeof i){for(s=-1,o=i.length;o-- >0;)if(i[o]===n||i[o].listener&&i[o].listener===n){l=i[o].listener,s=o;break}if(s<0)return this;if(1===i.length){if(i[0]=void 0,0==--this._eventsCount)return this._events=new t,this;delete r[e]}else!function(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}(i,s);r.removeListener&&this.emit("removeListener",e,l||n)}return this},n.prototype.removeAllListeners=function(e){var n,i;if(!(i=this._events))return this;if(!i.removeListener)return 0===arguments.length?(this._events=new t,this._eventsCount=0):i[e]&&(0==--this._eventsCount?this._events=new t:delete i[e]),this;if(0===arguments.length){for(var r,s=Object.keys(i),o=0;o<s.length;++o)"removeListener"!==(r=s[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new t,this._eventsCount=0,this}if("function"==typeof(n=i[e]))this.removeListener(e,n);else if(n)do{this.removeListener(e,n[n.length-1])}while(n[0]);return this},n.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):c.call(e,t)},n.prototype.listenerCount=c,n.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};class u extends n{constructor(e,t){super(),this.value=e,this.dep=[],this.dataProxy=t}setDep(e){this.dep.push(e)}valueOf(){return this.value}toString(){return this.value}set(e){this.value=e}get(){return this.value}notify(){this.dep.forEach((e=>{e.update()})),this.emit("change",this.value)}}class d{constructor(e){this.fn=e}update(){this.fn()}}class v{constructor(){this.valueMap=new WeakMap}getProp(e,t){this.valueMap.get(e)||this.valueMap.set(e,{});let n=this.valueMap.get(e);if(!n[t]){let i=new u(Array.isArray(e[t])?new Proxy(e[t],{set(e,t,n,r){let s=Reflect.set(e,t,n,r);return i.notify(),s}}):e[t]);n[t]=i}return n[t]}getEventProxy(e){return this.valueMap.get(e)}setEventProxy(e,t){this.valueMap.set(e,t)}}class y{constructor(e){this.target=e,this.dataProxyValue=new v;const t={get:(e,n,i)=>{if("object"!=typeof e[n]||null===e[n]||Array.isArray(e[n])||e[n].constructor!==Object){if("function"==typeof e[n])return Reflect.get(e,n,i);{let t=this.dataProxyValue.getProp(e,n);for(let e of N.depPool)e.includes(t)||e.push(t);return t.value}}return new Proxy(e[n],t)},set:(e,t,n,i)=>{if("object"!=typeof n||null===n||Array.isArray(n)||n.constructor!==Object){let r=this.dataProxyValue.getProp(e,t);r.value=Array.isArray(n)?new Proxy(n,{set(e,t,n,i){let s=Reflect.set(e,t,n,i);return r.notify(),s}}):n;let s=Reflect.set(e,t,n,i);return r.notify(),s}{let r=this.dataProxyValue.getEventProxy(e[t]),s=Reflect.set(e,t,n,i);return this.replaceProps(n,r),s}}};this.data=new Proxy(e,t)}getData(){return this.data}getTarget(){return this.target}getEventProxy(){return this.dataProxyValue}replaceProps(e,t){for(let n in t){let i=t[n];i.value=e[n],i.notify()}this.dataProxyValue.setEventProxy(e,t)}}class m{constructor(e={}){this.config=e,this.setData()}setData(){this.data=new y(this.config.data||{}).getData()}setProps(e){this.props=e}setChildren(e){this.children=e}renderRoot(){return this.render(L)}}class g{}g.ELEMENT=0,g.TEXT=1,g.COMPONENT=2;class w extends g{constructor(e,t,n){super(),this.type=g.COMPONENT,this.Constructor=e,this.props=t||{},this.children=n||[]}init(){let e=new y({}).getData();for(let t in this.props){if("function"!=typeof this.props[t]){e[t]=this.props[t];continue}let n=[],i=N.depPool;i.push(n);let r=this.props[t]();if(i.splice(i.indexOf(n),1),"function"==typeof r)e[t]=r;else{e[t]=r;let i=()=>e[t]=this.props[t]();n.forEach((e=>{e.setDep(new d(i))}))}}let t=new y([]).getData();if(this.children)for(let e=0;e<this.children.length;e++){if("function"!=typeof this.children[e]){t[e]=this.children[e];continue}let n=[],i=N.depPool;i.push(n);let r=this.children[e]();if(i.splice(i.indexOf(n),1),"function"==typeof r)t[e]=r;else{t[e]=r;let i=()=>t[e]=this.children[e]();n.forEach((e=>{e.setDep(new d(i))}))}}let n=this.Constructor;n.prototype?this.component=new n(e,t):this.component=n(e,t),this.component instanceof m&&(this.component.setProps(e),this.component.setChildren(t))}getComponent(){return this.init(),this.component}}class x extends g{constructor(e){super(),this.type=g.TEXT,this.text=e}createTextNode(){return this.textNode=document.createTextNode(this.text),this.textNode}}class E extends g{constructor(e,t,n){super(),this.type=g.ELEMENT,this.tag=e,this.props=t,this.children=n}createEle(){var e;if(this.ele=document.createElement(this.tag),this.props)for(let t in this.props)if("function"==typeof this.props[t]){let n=[],i=N.depPool;i.push(n);let r=this.props[t]();if(i.splice(i.indexOf(n),1),"function"==typeof r){let e=/^on([a-zA-Z]+)/;if(e.test(t)){let n=t.match(e);n&&this.ele.addEventListener(n[1].toLocaleLowerCase(),r.bind(this.ele))}else this.ele.addEventListener(t,r.bind(this.ele))}else if("style"===t&&"object"==typeof r){let e=()=>{var e;let n=this.props[t](),i=[];for(let e in n)i.push(`${e}:${n[e]};`);null===(e=this.ele)||void 0===e||e.setAttribute(t,i.join(""))};e(),n.forEach((t=>{t.setDep(new d(e))}))}else if("className"===t){this.ele.className=r;let e=()=>this.ele.className=this.props[t]();n.forEach((t=>{t.setDep(new d(e))}))}else{null===(e=this.ele)||void 0===e||e.setAttribute(t,r);let i=()=>{var e;return null===(e=this.ele)||void 0===e?void 0:e.setAttribute(t,this.props[t]())};n.forEach((e=>{e.setDep(new d(i))}))}}else"className"===t?this.ele.className=this.props[t]:this.ele.setAttribute(t,this.props[t]);if(Array.isArray(this.children)&&this.children.length)for(let e of this.children)this.addChild(e);else void 0!==this.children&&null!==this.children&&this.addChild(this.children);return this.ele}getRealNode(e){let t=document.createTextNode("");if("string"==typeof e){t=new x(e).createTextNode()}else if(e instanceof m)t=e.renderRoot().createEle();else if(e instanceof w){let n=e.getComponent();n instanceof m?t=n.renderRoot().createEle():n instanceof E&&(t=n.createEle())}else if(e instanceof E)t=e.createEle();else if(e instanceof x)t=e.createTextNode();else{t=new x(String(e)).createTextNode()}return t}getRealNodeList(e){let t=[];for(let n of e)t.push(this.getRealNode(n));return t}addChildren(e,t){var n;let i=document.createDocumentFragment();for(let t of e)i.appendChild(t);null===(n=this.ele)||void 0===n||n.insertBefore(i,t)}removeChildren(e){for(let t of e)t.remove()}addChild(e){if(this.ele)if("string"==typeof e){let t=new x(e);this.ele.appendChild(t.createTextNode())}else if(e instanceof m)this.ele.appendChild(e.renderRoot().createEle());else if(e instanceof w){let t=e.getComponent();t instanceof m?this.ele.appendChild(t.renderRoot().createEle()):t instanceof E&&this.ele.appendChild(t.createEle())}else if(e instanceof E)this.ele.appendChild(e.createEle());else if(e instanceof x)this.ele.appendChild(e.createTextNode());else if("function"==typeof e){let t=[],n=N.depPool;n.push(t);let i=e();if(n.splice(n.indexOf(t),1),Array.isArray(i)){let n=document.createTextNode("");this.ele.appendChild(n);let r=this.getRealNodeList(i);if(this.addChildren(r,n),!t.length)return;let s=()=>{this.removeChildren(r);let t=e();Array.isArray(t)&&(r=this.getRealNodeList(t),this.addChildren(r,n))};for(let e of t)e.setDep(new d(s))}else{let n=this.getRealNode(i);if(this.ele.appendChild(n),!t.length)return;let r=()=>{var t,i;let r=e(),s=this.getRealNode(r);s?s.nodeType===n.nodeType?n.nodeValue=s.nodeValue:(null===(t=this.ele)||void 0===t||t.replaceChild(s,n),n=s):null===(i=this.ele)||void 0===i||i.replaceChild(n=document.createTextNode(""),n)};for(let e of t)e.setDep(new d(r))}}else if(Array.isArray(e))for(let t of e)this.addChild(t);else{let t=new x(String(e));this.ele.appendChild(t.createTextNode())}}setProps(){var e;if(this.props&&this.ele)for(let t in this.props)if("function"==typeof this.props[t]){let n=[],i=N.depPool;i.push(n);let r=this.props[t]();if(i.splice(i.indexOf(n),1),"function"==typeof r){let e=/^on([a-zA-Z]+)/;if(e.test(t)){let n=t.match(e);n&&this.ele.addEventListener(n[1].toLocaleLowerCase(),r.bind(this.ele))}else this.ele.addEventListener(t,r.bind(this.ele))}else if("style"===t&&"object"==typeof r){C(this.ele,t,r);let e=()=>{let e=this.props[t]();C(this.ele,t,e)};n.forEach((t=>{t.setDep(new d(e))}))}else if("className"===t){this.ele.className=r;let e=()=>this.ele.className=this.props[t]();n.forEach((t=>{t.setDep(new d(e))}))}else{null===(e=this.ele)||void 0===e||e.setAttribute(t,r);let i=()=>{var e;return null===(e=this.ele)||void 0===e?void 0:e.setAttribute(t,this.props[t]())};n.forEach((e=>{e.setDep(new d(i))}))}}else C(this.ele,t,this.props[t])}}function C(e,t,n){if("string"==typeof n)"className"===t?e.className=n:e.setAttribute(t,n);else if("object"==typeof n&&null!==n){let i=[];for(let e in n)i.push(`${e}:${n[e]};`);e.setAttribute(t,i.join(""))}}function L(e,t,n){if("string"==typeof e)return new E(e,t,n);if("function"==typeof e)return new w(e,t,n);throw new Error("只能传入字符串或者构造函数")}class N{static getDepPool(){return this.depPool}}N.depPool=[],N.Component=m,N.mount=function(e,t){let n=document.querySelector(e),i=t.renderRoot().createEle();n&&i&&n.parentNode&&n.parentNode.replaceChild(i,n)},N.createNode=L;class P{constructor(e,t){this.dataProxy=new y(e),this.config=t}get data(){return this.dataProxy.getData()}watch(e,t){let n=e.split(".");if(!n.length)return;let i=this.dataProxy.getTarget(),r=n.shift()||"";for(;n.length;){let e=n.shift();e&&(i=i[r],r=e)}this.dataProxy.getEventProxy().getProp(i,r).on("change",t)}}const b=N.mount,_=N.Component,A=N.createNode;e.Component=_,e.createNode=A,e.default=N,e.defineState=function(e,t){return new P(e,t)},e.mount=b,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=boundle.umd.js.map
